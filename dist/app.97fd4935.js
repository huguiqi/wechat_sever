!function(e){function t(n){if(o[n])return o[n].exports;var i=o[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var o={};return t.m=e,t.c=o,t.p="",t(0)}([function(e,t,o){o(156),angular.module("YApp",["ui.router","LocalStorageModule","ngSanitize","oc.lazyLoad"]).config(["$controllerProvider","$compileProvider","$filterProvider","$provide","$httpProvider","$sceDelegateProvider",function(e,t,o,n,i,a){app.controller=e.register,app.directive=t.directive,app.filter=o.register,app.factory=n.factory,app.service=n.service,app.constant=n.constant,app.value=n.value,a.resourceUrlWhitelist(["**"])}]).run(["$rootScope","$state","$stateParams","wxsdkService","aMapService","toolsService","cacheService",function(e,t,o,n,i,a,r){Fastclick.attach(document.body);var c=a.getUrlParam("userId")||r.userId.get(),s=a.getUrlParam("activityId")||r.activityId.get(),l=a.getUrlParam("avatar")?a.getUrlParam("avatar"):r.userInfo.get()?r.userInfo.get().avatar:"http://cdn.4001583721.com/default_avatar1.png?imageView2/1/w/100/h/100/q/100",g=""!==a.getUrlParam("member")?a.getUrlParam("member"):0,u=""!==a.getUrlParam("sourceId")?a.getUrlParam("sourceId"):0,d=""!==a.getUrlParam("sort")?a.getUrlParam("sort"):0;type=""!==a.getUrlParam("type")?a.getUrlParam("type"):0,r.isSupported()&&c?(r.userId.set(c),r.activityId.set(s),r.userInfo.set({avatar:l,isMember:1==parseInt(g),type:parseInt(type),sourceId:u,sort:d})):alert("请在微信端打开"),n.init().then(function(e){wx.config(e),r.location.remove(),wx.ready(function(){n.getLocation(function(e){i.getAddress([e.longitude,e.latitude],function(t){r.location.set({lat:e.latitude,lon:e.longitude,city:t.addressComponent.city||t.addressComponent.province})})})})},function(){}),e.$on("$stateChangeSuccess",function(o){e.pageLoading=!0,e.isPageCover=!1,e.isPageMinCover=!0,e.isPageWhite=!1,"wechatError"!==t.current.name&&!a.isWechat()})}]),o(101),o(140),o(143),o(138),o(133),o(129),o(132),window.adaptive.desinWidth=750,window.adaptive.baseFont=14,window.adaptive.maxWidth=480,window.adaptive.init()},,function(e,t){var o={campaign:"http://wechat.iqixue.com/event?id=56d41a965c5595a503765227",course:"http://wechat.iqixue.com/event?id=56fced05e385105c15b3fb40",distribution:"http://wechat.iqixue.com/event?id=57382a540d5c383d1af424f7",distributionCenter:"http://wechat.iqixue.com/event?id=5738286d4707c5a819aee6bb",distributionPrincipal:"http://wechat.iqixue.com/event?id=574670a5377b1b51057d2fb4"};e.exports=o},function(e,t){var o="pro",n="pro"===o?"http://gf.api.iqixue.com":"test"===o?"http://gf.api.4001583721.cn":"http://localhost:5003",i="pro"===o?"567ca3554574cd47633b2c4c":"56efa0bff5bdb0ec30d6e4b8",a="56f4b6c40ba3fa232c12eee2",r={campaign:n+"/v1/rest",course:n+"/v1/rest",school:n+"/v1/rest",distribution:n+"/v1/rest",wechatId:i,courseCategoryId:a};e.exports=r},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){angular.module("YApp").constant("MODULE_CONFIG",[{name:"video-js",files:["lib/video/video.min.js","lib/video/video-js.min.css"]}]).constant("JQ_CONFIG",{amap:[{type:"js",path:"http://webapi.amap.com/maps?v=1.3&key=c87d91e9d9c9eceeed4bd1776801464b"}],swiper:["lib/swiper/swiper.min.css","lib/swiper/swiper.min.js"],"jquery-qrcode":["lib/jquery-qrcode/jquery.qrcode.min.js","lib/jquery-qrcode/qrcode.js"]}).config(["$ocLazyLoadProvider","MODULE_CONFIG",function(e,t){e.config({debug:!1,events:!0,modules:t})}])},function(e,t,o){var n=o(2);angular.module("YApp").controller("campaignDetailCtrl",["$rootScope","$scope","$state","$stateParams","$timeout","campaignModel","toolsService","wxsdkService","cacheService","toolsService",function(e,t,o,i,a,r,c,s,l,c){function g(){var o=t;r.detail({id:i.id,userId:l.userId.get()}).then(function(t){a(function(){e.pageLoading=!1}),o.campaign=t.campaign,o.campaign.school=t.school,o.campaign.minPrice=t.price,o.campaignOrder.mobile=t.mobile,o.campaign.overTime=o.campaign.overTime||o.campaign.endTime,o.campaignIsOver=o.campaign.overTime<=parseInt((new Date).getTime()/1e3,10),!o.campaignIsOver&&p(),c.setTitleForIphone(t.name),o.campaign.images.length>=1?(o.imageShow=2,u()):o.imageShow=0,wx.ready(function(){d()}),window.scrollTo(0,0)},function(){})}function u(){for(var e=[],o=0;o<t.campaign.images.length;o++){var n='<img src="'+t.campaign.images[o]+'?imageView2/1/w/750/h/400/q/100">';e.push({content:n})}e.length>4&&(e=e.slice(0,5));var i=new iSlider({dom:document.getElementById("J_sliderWraper"),type:"dom",data:e,duration:5e3,isLooping:!0,isAutoplay:!0,fixPage:!1});i.addDot()}function d(){var e=t;s.shareAppMessage({title:e.campaign.name,link:C,desc:"在学习中玩耍，找翼起学！百个教育活动任你选",imgUrl:(e.campaign.images[0]||e.campaign.cover)+"?imageView2/1/w/400/h/400/q/80",success:function(){}}),s.shareTimeline({title:e.campaign.name,link:C,imgUrl:(e.campaign.images[0]||e.campaign.cover)+"?imageView2/1/w/400/h/400/q/80",success:function(){}})}function p(){var e,o=t,n=o.campaign.overTime,i=document.getElementById("J_timer");f=setInterval(function(){e=c.calculationCountdown(n),e?i.innerHTML="离报名结束还有"+e[0]+"天"+e[1]+"小时"+e[2]+"分"+e[3]+"秒":a(function(){o.campaignIsOver=!0,clearInterval(f)})},1e3)}function m(){window.scrollTo(0,0),g()}var f,r=new r,h=l.userInfo.get(),v=l.userId.get(),C=n.campaign+",campaign/detail/"+i.id+(h.isMember?","+v:"");$("#J_campaignDetail").css("minHeight",$(document.body)[0].scrollHeight),t.userInfo=h,t.shareLink=C,t.campaign={name:"",description:"",cover:"",poster:"",video:"",sponsor:"",startTime:"",endTime:"",overTime:"",address:"",personName:"",phone:"",images:[]},t.campaignOrder={campaignId:i.id,mobile:""},t.campaignIsOver=!1,t.imageShow=2,t.singup=function(){var e=t;l.campaignOrder.set(e.campaignOrder),o.go("order")},t.openLocation=function(){var e=t;s.openLocation({lat:e.campaign.location[1],lon:e.campaign.location[0],name:e.campaign.name,address:e.campaign.address})},m()}])},function(e,t,o){o(104),o(102),o(105),o(106),o(107)},function(e,t,o){var n=o(2);angular.module("YApp").controller("campaignListCtrl",["$rootScope","$scope","$state","$stateParams","$timeout","campaignModel","cacheService","toolsService","wxsdkService",function(e,t,o,i,a,r,c,s,l){function g(){for(var e,o,n,i,a=t,r=parseInt((new Date).getTime()/1e3,10),c=$("#J_campaignList").find(".time"),s=0;s<a.campaign.length;s++){var l=parseInt(a.campaign[s].overTime,10)-r;0>=l?c.eq(s).text("报名已截止，下次再约啦~"):(e=parseInt(l/86400,10),o=parseInt(l%86400/3600,10),n=parseInt(l%86400%3600/60,10),i=parseInt(l%86400%3600%60,10),c.eq(s).text("报名截止: 剩余"+e+"天"+o+"小时"+n+"分"+i+"秒"))}}function u(e){var o=t;window.clearInterval(h),o.campaign=[],o.listShow=e,o.pageConfig.loadingProcess=!0,o.pageConfig.start=1,o.pageConfig.loadingText="努力加载中...",o.pageConfig.showLoading=!0,o.pageConfig.hasNoData=!1,d()}function d(){var o=t;1==o.listShow&&r.recommendList({id:i.id,start:o.pageConfig.start,limit:o.pageConfig.limit}).then(function(e){e&&e.data?(o.campaign=o.pageConfig.loadingProcess?e.data:o.campaign.concat(e.data),o.timeShow=!0,o.pageConfig.loadingProcess=!1,o.pageConfig.showLoading=e.data.length<o.pageConfig.limit,o.pageConfig.hasNoData=e.data.length<o.pageConfig.limit,o.pageConfig.scrollAble=e.data.length===o.pageConfig.limit,o.pageConfig.scrollAble?o.pageConfig.loadingText="努力加载中...":o.pageConfig.loadingText="没有更多了..."):(o.pageConfig.showLoading=!0,o.pageConfig.loadingText="网络错误，请刷新再试...")},function(){}),2==o.listShow&&r.hostList({id:i.id,start:o.pageConfig.start,limit:o.pageConfig.limit}).then(function(t){a(function(){e.pageLoading=!1}),t&&t.data?(o.campaign=o.pageConfig.loadingProcess?t.data:o.campaign.concat(t.data),o.timeShow=!0,o.pageConfig.loadingProcess=!1,o.pageConfig.showLoading=t.data.length<o.pageConfig.limit,o.pageConfig.hasNoData=t.data.length<o.pageConfig.limit,o.pageConfig.scrollAble=t.data.length===o.pageConfig.limit,o.pageConfig.scrollAble?o.pageConfig.loadingText="努力加载中...":o.pageConfig.loadingText="没有更多了..."):(o.pageConfig.showLoading=!0,o.pageConfig.loadingText="网络错误，请刷新再试...")},function(){}),3==o.listShow&&r.nearList({id:i.id,start:o.pageConfig.start,limit:o.pageConfig.limit,lat:v.lat,lon:v.lon,city:v.city}).then(function(e){e&&e.data?(o.campaign=o.pageConfig.loadingProcess?e.data:o.campaign.concat(e.data),o.timeShow=!0,o.pageConfig.loadingProcess=!1,o.pageConfig.showLoading=e.data.length<o.pageConfig.limit,o.pageConfig.hasNoData=e.data.length<o.pageConfig.limit,o.pageConfig.scrollAble=e.data.length===o.pageConfig.limit,o.pageConfig.scrollAble?o.pageConfig.loadingText="努力加载中...":(o.pageConfig.loadingText="没有更多了...",o.pageConfig.loadingProcess=!0)):(o.pageConfig.showLoading=!0,o.pageConfig.loadingText="网络错误，请刷新再试...")},function(){}),a(function(){h=setInterval(g,1e3)},500)}function p(){var e=t,o=window,n=document.body;$(o).bind("scroll",function(){o.scrollY+o.innerHeight>=n.offsetHeight-60&&e.pageConfig.scrollAble&&!e.pageConfig.loadingProcess&&(e.pageConfig.showLoading=!0,e.pageConfig.start++,d())})}function m(){l.shareAppMessage({title:"孩子周末去哪儿？",link:n.campaign,desc:"在学习中玩耍，找翼起学！百个教育活动任你选",imgUrl:"http://cdn.4001583721.com/share.jpg",success:function(){}}),l.shareTimeline({title:"孩子周末去哪儿？",link:n.campaign,imgUrl:"http://cdn.4001583721.com/share.jpg",success:function(){}})}function f(){p(),d(),wx.ready(function(){m()})}var h,r=new r,v=c.location.get()||{lat:31.29607,lon:121.4961,city:"上海市"};$("#J_campaignList").css("minHeight",$(document.body)[0].scrollHeight),s.setTitleForIphone("找活动"),t.nowTime=parseInt((new Date).getTime()/1e3,10),t.pageConfig={start:1,limit:5,showLoading:!0,loadingText:"努力加载中...",loadingProcess:!0,scrollAble:!1,hasNoData:!1},t.listShow=2,t.timeShow=!1,t.campaign=[],t.getCampaignList=u,t.personInfo={userId:s.getUrlParam("userId"),avatar:s.getUrlParam("avatar")},t.$on("$destroy",function(){$(window).unbind("scroll")}),t.openCampaignDetail=function(e){var n=t;window.clearInterval(h),n.campaign=[],o.go("campaign.detail",{id:e})},f()}]),angular.module("YApp").controller("campaignCenterNav",["$rootScope","$scope","$state","$stateParams","$timeout","cacheService",function(e,t,o,i,a,r){t.showNav=!1,t.link=n,t.userInfo=r.userInfo.get()}])},function(e,t,o){var n=o(2);angular.module("YApp").controller("myCampaignCtrl",["$rootScope","$scope","$state","$stateParams","$timeout","campaignModel","courseModel","toolsService","cacheService","wxsdkService",function(e,t,o,i,a,r,c,s,l,g){function u(){var e=t;1==e.listShow&&d(),2==e.listShow&&p(),3==e.listShow&&m()}function d(){var o=t;r.myCampaign({userId:l.userId.get(),limit:o.pageConfig.limit,start:o.pageConfig.start}).then(function(t){a(function(){e.pageLoading=!1}),t&&t.length>-1?(o.campaignOrder=o.pageConfig.loadingProcess?t:o.campaignOrder.concat(t),f(o.campaignOrder),o.pageConfig.loadingProcess=!1,o.pageConfig.showLoading=t.length<o.pageConfig.limit,o.pageConfig.hasNoData=t.length<o.pageConfig.limit,o.pageConfig.scrollAble=t.length===o.pageConfig.limit,o.pageConfig.scrollAble?o.pageConfig.loadingText="努力加载中...":o.pageConfig.loadingText="没有更多了~~"):(o.pageConfig.showLoading=!0,o.pageConfig.loadingText="网络错误，请刷新再试...")},function(){})}function p(){var o=t;c.userOrder({userId:l.userId.get(),limit:o.pageConfig.limit,start:o.pageConfig.start}).then(function(t){a(function(){e.pageLoading=!1}),t&&t.length>-1?(o.courseOrder=o.pageConfig.loadingProcess?t:o.courseOrder.concat(t),v(o.courseOrder),o.pageConfig.loadingProcess=!1,o.pageConfig.showLoading=t.length<o.pageConfig.limit,o.pageConfig.hasNoData=t.length<o.pageConfig.limit,o.pageConfig.scrollAble=t.length===o.pageConfig.limit,o.pageConfig.scrollAble?o.pageConfig.loadingText="努力加载中...":o.pageConfig.loadingText="没有更多了~~"):(o.pageConfig.showLoading=!0,o.pageConfig.loadingText="网络错误，请刷新再试...")},function(e){console.log(e)})}function m(){var e=t;c.userFavorite({userId:l.userId.get(),limit:e.pageConfig.limit,start:e.pageConfig.start}).then(function(t){t&&t.length>-1?(e.collect=e.pageConfig.loadingProcess?t:e.collect.concat(t),e.pageConfig.loadingProcess=!1,e.pageConfig.showLoading=t.length<e.pageConfig.limit,e.pageConfig.hasNoData=t.length<e.pageConfig.limit,e.pageConfig.scrollAble=t.length===e.pageConfig.limit,e.pageConfig.scrollAble?e.pageConfig.loadingText="努力加载中...":e.pageConfig.loadingText="没有更多了~~"):(e.pageConfig.showLoading=!0,e.pageConfig.loadingText="网络错误，请刷新再试...")},function(e){console.log(e)})}function f(e){for(var o=t,n=0;n<e.length;n++)1===e[n].trade.status&&(e[n].trade.over=0,moment().diff(moment(1e3*e[n].trade.created))>72e5?e[n].trade.over=0:e[n].trade.over=1);a(function(){o.campaignOrder=e;window.setInterval(h,1e3)})}function h(){for(var e=t,o=[],n=(new Date).getTime(),n=parseInt(n/1e3),i=0;i<e.campaignOrder.length;i++){var a=7200-(n-e.campaignOrder[i].trade.created),r=parseInt(a/3600),c=parseInt(a%3600/60),s="未付款 请于"+r+"小时"+c+"分钟内完成付款";$(".campaignCountDown").find(".timer").eq(i).text(s),0>a&&(o.push(a),o.length<1&&window.clearInterval(campaignTimes))}}function v(e){for(var o=t,n=0;n<e.length;n++)1===e[n].trade.status&&(e[n].trade.over=0,moment().diff(moment(1e3*e[n].trade.created))>72e5?e[n].trade.over=0:e[n].trade.over=1);a(function(){o.courseOrder=e;window.setInterval(C,1e3)})}function C(){for(var e=t,o=[],n=(new Date).getTime(),n=parseInt(n/1e3),i=0;i<e.courseOrder.length;i++){var a=7200-(n-e.courseOrder[i].trade.created),r=parseInt(a/3600),c=parseInt(a%3600/60),s="未付款 请于"+r+"小时"+c+"分钟内完成付款";$(".courseCountDown").find(".timer").eq(i).text(s),0>a&&(o.push(a),o.length<1&&window.clearInterval(courseTimes))}}function w(){var e=t,o=window,n=document.body;$(o).bind("scroll",function(){o.scrollY+o.innerHeight>=n.offsetHeight-60&&e.pageConfig.scrollAble&&!e.pageConfig.loadingProcess&&(e.pageConfig.showLoading=!0,e.pageConfig.start++,u())})}function b(){g.shareAppMessage({title:"孩子周末去哪儿？",link:n.campaign,desc:"在学习中玩耍，找翼起学！百个教育活动任你选",imgUrl:"http://cdn.4001583721.com/share.jpg",success:function(){}}),g.shareTimeline({title:"孩子周末去哪儿？",link:n.campaign,imgUrl:"http://cdn.4001583721.com/share.jpg",success:function(){}})}function I(){w(),wx.ready(function(){b()}),u()}s.setTitleForIphone("我的活动");var r=new r,c=new c;a(function(){e.pageLoading=!1}),t.pageConfig={start:1,limit:5,showLoading:!0,loadingText:"努力加载中...",loadingProcess:!0,scrollAble:!1,hasNoData:!1},t.listShow=1,t.collect=[],t.courseOrder=[],t.campaignOrder=[],t.getList=function(e){var o=t;o.collect=[],o.courseOrder=[],o.campaignOrder=[],o.pageConfig.start=1,o.listShow=e,u()},t.$on("$destroy",function(){$(window).unbind("scroll")}),t.payAgain=function(e,t){"course"===t&&c.payAgain({_id:e.trade._id}).then(function(e){l.courseOrder.set(e),location=location.protocol+"//"+location.host+"/index.html#/common/pay/course",location.reload()},function(){}),"campaign"===t&&r.payAgain({_id:e.trade._id}).then(function(e){l.campaignOrder.set(e),location=location.protocol+"//"+location.host+"/index.html#/common/pay/campaign",location.reload()},function(){})},I()}])},function(e,t,o){var n=o(2);angular.module("YApp").controller("campaignOrder",["$rootScope","$scope","$state","$stateParams","$timeout","cacheService","wxsdkService","campaignModel","toolsService",function(e,t,o,i,a,r,c,s,l){function g(){var o=t;s.ticketList({id:m}).then(function(t){a(function(){e.pageLoading=!1}),o.campaign=t.campaign,o.ticketList=t.eTicket,o.order.price=o.ticketList[0].price,o.order.eTicketId=o.ticketList[0]._id,o.maxNum=o.ticketList[0].remainder>=0&&o.ticketList[0].remainder<10?o.ticketList[0].remainder:10,o.order.num=0===o.ticketList[0].remainder?0:1,wx.ready(function(){u()})},function(){})}function u(){var e=t;c.shareAppMessage({title:e.campaign.name,link:v,desc:"在学习中玩耍，找翼起学！百个教育活动任你选",imgUrl:e.campaign.cover+"?imageView2/1/w/400/h/400/q/80",success:function(){}}),c.shareTimeline({title:e.campaign.name,link:v,imgUrl:e.campaign.cover+"?imageView2/1/w/400/h/400/q/80",success:function(){}})}function d(){g()}var s=new s,p=r.campaignOrder.get(),m=p.campaignId||p.order.campaignId,f=r.userInfo.get(),h=r.userId.get(),v=n.campaign+",campaign/detail/"+m+(f.isMember?","+h:"");$("#J_campaignOrder").css("minHeight",$(document.body)[0].scrollHeight),l.setTitleForIphone("订单确认"),e.isPageMinCover=!0,t.currentTicketIndex=0,t.maxNum=1,t.order={userId:r.userId.get(),campaignId:m,num:1,mobile:p.mobile||(p.order?p.order.mobile:""),price:0,eTicketId:0},t.tipView={tip:!1,text:""},t.submit=function(){var e=t;return 0===e.maxNum?(e.tipView.text="该票已售罄",e.tipView.show=!0,a(function(){e.tipView.show=!1},1e3),!1):(p.price=e.order.price,p.num=e.order.num,p.eTicketId=e.order.eTicketId,r.campaignOrder.set(p),void(e.order.mobile?o.go("campaign.question"):o.go("common.setPhone",{type:"campaign"})))},t.subNum=function(){var e=t;e.order.num>1&&(e.order.num--,e.order.price=e.ticketList[e.currentTicketIndex].price*e.order.num)},t.addNum=function(){var e=t;e.order.num<e.maxNum&&(e.order.num++,e.order.price=e.ticketList[e.currentTicketIndex].price*e.order.num)},t.ticketSelect=function(e){var o=t;o.currentTicketIndex=e,o.order.num=0===o.ticketList[e].remainder?0:1,o.order.price=o.ticketList[e].price,o.order.eTicketId=o.ticketList[e]._id,o.maxNum=o.ticketList[e].remainder>=0&&o.ticketList[e].remainder<10?o.ticketList[e].remainder:10},d()}])},function(e,t,o){var n=o(2);angular.module("YApp").controller("campaignQuestionCtrl",["$rootScope","$scope","$state","$stateParams","$timeout","campaignModel","toolsService","wxsdkService","cacheService","toolsService",function(e,t,o,i,a,r,c,s,l,c){function g(){var o=t;r.questionList({campaignId:v.campaignId||v.order.campaignId}).then(function(t){e.pageLoading=!1,o.questionList=t.data,u(o.questionList)},function(){})}function u(e){var o=t,n=[];o.questionForm.name="",o.questionForm.mobile=o.order.mobile;for(var i=0;i<e.length;i++)if(1===e[i].type)o.questionForm[e[i]._id+"_"+e[i].type]=e[i].item[0]._id;else if(2===e[i].type){for(var a=0;a<e[i].item.length;a++)n.push("");o.questionForm[e[i]._id+"_"+e[i].type]=n}else o.questionForm[e[i]._id+"_"+e[i].type]=""}function d(){var e=t,o=e.questionForm,n=!0;for(var i in o)"string"==typeof o[i]&&""===o[i]?n=!1:"object"==typeof o[i]&&0===o[i].join("").length&&(n=!1);return n}function p(){var e,o=t,n=[];for(var i in o.questionForm)"name"===i?n.push({name:o.questionForm[i]}):"mobile"===i?n.push({mobile:o.questionForm[i]}):(e={},e.id=i.split("_")[0],e.type=+i.split("_")[1],e.value="string"==typeof o.questionForm[i]?o.questionForm[i]:o.questionForm[i].join(","),n.push(e));return n}function m(e){var n=t;return e.$invalid||!d()||n.saveStatus.loading?!1:(n.order.answer[n.editIndex]=p(),void(n.editIndex<n.order.num-1?(n.editIndex+=1,u(n.questionList),window.scrollTo(0,0)):(n.saveStatus.text="报名中...",n.saveStatus.loading=!0,r.order(n.order).then(function(e){return e&&"ProtocolError"===e.name?(alert("微信协议错误，此活动不能支付，请联系管理员"),!1):void(e&&0===e.order.price?(alert("您已报名成功，报名详细信息已发送到您的手机上，谢谢"),o.go("campaign.myCampaign")):(e.order.mobile=v.mobile||v.order.mobile,l.campaignOrder.set(e),location=location.protocol+"//"+location.host+"/index.html#/common/pay/campaign",location.reload()))},function(){alert("提交订单失败")}))))}function f(){s.shareAppMessage({title:"孩子周末去哪儿？",link:n.campaign,desc:"在学习中玩耍，找翼起学！百个教育活动任你选",imgUrl:"http://cdn.4001583721.com/share.jpg",success:function(){}}),s.shareTimeline({title:"孩子周末去哪儿？",link:n.campaign,imgUrl:"http://cdn.4001583721.com/share.jpg",success:function(){}})}function h(){wx.ready(function(){f()}),g()}var r=new r,v=l.campaignOrder.get(),C=l.userInfo.get(),v=l.campaignOrder.get();$("#J_campaignDetail").css("minHeight",$(document.body)[0].scrollHeight),c.setTitleForIphone("填写参与人信息"),t.order={userId:l.userId.get(),campaignId:v.campaignId||v.order.campaignId,num:v.num||v.order.num,mobile:parseInt(v.mobile||v.order.mobile,10),price:void 0!==v.price?v.price:v.order.price,eTicketId:v.eTicketId||v.order.eTicketId,sourceId:C.sourceId,answer:[]},t.questionList=[],t.tipView={show:!1,text:""},t.saveStatus={text:t.order.num>1?"下一位参与人信息":"确认报名",loading:!1},t.questionForm={},t.submit=m,t.validateQuestion=d,t.editIndex=0,t.$watch("editIndex",function(e,o){var n=t;e===n.order.num-1&&(n.saveStatus.text="确认报名")}),h()}])},function(e,t,o){o(111),o(109),o(110)},function(e,t,o){o(2);angular.module("YApp").controller("commonPayCtrl",["$rootScope","$scope","$state","$stateParams","$timeout","cacheService","toolsService","wxsdkService",function(e,t,o,n,i,a,r,c){function s(){var e=t;WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:e.orderInfo.wechat.appId,timeStamp:e.orderInfo.wechat.timeStamp,nonceStr:e.orderInfo.wechat.nonceStr,"package":e.orderInfo.wechat["package"],signType:e.orderInfo.wechat.signType,paySign:e.orderInfo.wechat.paySign},function(t){"get_brand_wcpay_request:ok"==t.err_msg&&("distribution"===e.orderType&&o.go("distribution.group"),i(function(){e.payResult=!0}))})}function l(){var e=t,o=e.orderType;e.orderInfo=a[o+"Order"].get()}function g(){var e=t;u.type>2&&"distribution"===e.orderType?o.go("distribution.index"):l()}var u=a.userInfo.get();e.pageLoading=!1,r.setTitleForIphone("微信安全支付"),t.payResult=!1,t.orderType=n.type,t.pay=function(){"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",s,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",s),document.attachEvent("onWeixinJSBridgeReady",s)):s()},g()}])},function(e,t,o){o(2);angular.module("YApp").controller("commonSetPhoneCtrl",["$rootScope","$scope","$state","$stateParams","$timeout","$interval","courseModel","cacheService","toolsService","wxsdkService",function(e,t,o,n,i,a,r,c,s,l){function g(){var e,o=t,n=60;return o.sended?!1:void r.sendPhoneMsg({mobile:o.phone}).then(function(t){t&&0===t.errcode?(o.sended=!0,e=a(function(){o.timerText="重发("+n--+")",-1===n&&(a.cancel(e),o.sended=!1,o.timerText="重发")},1e3)):(alert("短信发送失败，请重发"),o.sended=!1,o.timerText="重发")})}var r=new r;s.setTitleForIphone("课程报名"),$("title").text("课程报名"),e.isPageMinCover=!0,e.pageLoading=!1,t.phone="",t.entered=!1,t.sended=!1,t.timerText="发送",t.code="",t.hideFooter=1,t.pageHeight=100,t.sendCode=g,t.verificationPhone=function(){var e=t,o=n.type,i=null;return s.checkPhone(e.phone)?("course"===o?(i=c.courseOrder.get(),i.mobile=e.phone,c.courseOrder.set(i)):"campaign"===o&&(i=c.campaignOrder.get(),i.mobile=e.phone,c.campaignOrder.set(i)),t.entered=!0,void g()):(alert("请输入正确的手机号"),!1)},t.verificationCode=function(){var e=t,i=n.type;return e.code?void r.verificationCode({mobile:e.phone,code:e.code}).then(function(e){e&&0===e.errcode?"course"===i?o.go("course.order"):o.go("campaign.question"):alert("验证码错误，请重新输入")}):(alert("请输入验证码"),!1)}}])},function(e,t,o){o(2);angular.module("YApp").controller("wechatErrorCtrl",["$rootScope","$scope","$state","toolsService",function(e,t,o,n){e.pageLoading=!1,n.setTitleForIphone("请在微信打开")}])},function(e,t,o){var n=o(2);angular.module("YApp").controller("courseDetailCtrl",["$rootScope","$scope","$state","$stateParams","$timeout","toolsService","wxsdkService","cacheService","courseModel",function(e,t,o,i,a,r,c,s,l){function g(){for(var e=t,o=[],n=0;n<e.courseData.photo.length;n++){var i='<img src="'+e.courseData.photo[n]+'">';o.push({content:i})}o.length>4&&(o=o.slice(0,5));var a=new iSlider({dom:document.getElementById("J_sliderWraper"),type:"dom",data:o,duration:5e3,isLooping:!0,isAutoplay:!0,fixPage:!1});a.addDot()}function u(){videojs(document.getElementById("J_video"),{},function(){})}function d(e){for(var o=t,n=0;n<e.length;n++)if(0!=e[n].num){o.courseView["class"]=n;break}}function p(){var o=t;l.detail({id:i.id,userId:s.userId.get()}).then(function(t){e.pageLoading=!1,o.courseData=t.courseData,o.classData=t.classData,o.schoolData=t.schoolData,o.schoolData.phone=t.schoolData.phone[0].split(","),o.courseView.status=t.favoriteData,o.courseOrder.classId=o.classData.length>0?t.classData[0]._id:"",o.courseOrder.mobile=t.mobile,a(function(){o.courseData.photo.reverse(),o.courseData.photo.length>0&&g()}),d(o.classData),o.courseData.video.length&&u(),m(),s.courseOrder.set(o.courseOrder),r.setTitleForIphone("课程详情")},function(e){console.log(e)})}function m(){var e=t;c.shareAppMessage({title:"翼起学精选课程："+e.courseData.name,link:C,desc:"翼起学本期精选的百个优质活动和课程，不多也不少！",imgUrl:e.courseData.cover||"http://cdn.4001583721.com/wx-course-share.png",success:function(){}}),c.shareTimeline({title:"翼起学精选课程："+e.courseData.name,link:C,imgUrl:e.courseData.cover||"http://cdn.4001583721.com/wx-course-share.png",success:function(){}})}function f(){p()}var l=new l,h=s.userInfo.get(),v=s.userId.get(),C=n.course+",course/detail/"+i.id+(h.isMember?","+v:"");t.userInfo=h,t.shareLink=C,t.courseView={status:"","class":0},t.tipView={tip:!1,text:""},t.courseOrder={classId:""},t.collect=function(e){var o=t;l.collect({schoolId:o.schoolData._id,courseId:o.courseData._id,creator:s.userId.get(),status:e}).then(function(t){t&&0==t.errcode?(o.courseView.status=e,o.tipView.tip=!0,1==o.courseView.status?o.tipView.text="收藏成功":0==o.courseView.status&&(o.tipView.text="已取消收藏"),a(function(){o.tipView.tip=!1},2e3)):o.tipView.text="收藏失败"},function(){})},t.classShow=function(e,o){var n=t;return 0===o.num?(n.tipView.tip=!0,n.tipView.text="已满员",a(function(){n.tipView.tip=!1},2e3),!1):(n.courseView["class"]=e,n.courseOrder.classId=o._id,void s.courseOrder.set(n.courseOrder))},t.openLocation=function(){var e=t;c.openLocation({lat:e.schoolData.location[1],lon:e.schoolData.location[0],name:e.courseData.schoolName,address:e.schoolData.address})},t.singup=function(){var e=t;return e.classData[e.courseView["class"]].num<1?(e.tipView.tip=!0,e.tipView.text="已满员",a(function(){e.tipView.tip=!1},2e3),!1):void(e.courseOrder.mobile?o.go("course.order"):o.go("common.setPhone",{type:"course"}))},f()}])},function(e,t,o){var n=o(2);angular.module("YApp").controller("courseHomeCtrl",["$rootScope","$scope","$state","$stateParams","$timeout","$location","cacheService","wxsdkService","toolsService","courseModel",function(e,t,o,i,a,r,c,s,l,g){function u(){var o=t;g.categoryList({id:o.firstCategoryId}).then(function(t){a(function(){e.pageLoading=!1}),o.courseList=t.data},function(){})}function d(){s.shareAppMessage({title:"翼起学本期精选课程",link:n.course,desc:"翼起学本期精选的百个优质活动和课程，不多也不少！",imgUrl:"http://cdn.4001583721.com/wx-course-share.png",success:function(){}}),s.shareTimeline({title:"翼起学本期精选课程",link:n.course,imgUrl:"http://cdn.4001583721.com/wx-course-share.png",success:function(){}})}function p(){u(),wx.ready(function(){d()})}var g=new g;l.setTitleForIphone("找课程"),t.firstCategoryId=i.id,p()}]),angular.module("YApp").controller("courseCenterNav",["$rootScope","$scope","$state","$stateParams","$timeout","cacheService",function(e,t,o,i,a,r){t.showNav=!1,t.link=n,t.userInfo=r.userInfo.get()}])},function(e,t,o){o(113),o(115),o(112),o(119),o(117),o(116),o(118)},function(e,t,o){var n=o(2);angular.module("YApp").controller("courseListCtrl",["$rootScope","$scope","$state","$stateParams","$timeout","$location","courseModel","cacheService","wxsdkService",function(e,t,o,i,a,r,c,s,l){function g(e){C.slideTo(e),r.search("item",e)}function u(){var o=t;c.categoryList({id:i.firstCategoryId}).then(function(t){a(function(){e.pageLoading=!1,o.courseCategory=t.data,o.activeIndex=d(),setTimeout(function(){p(),m()})})},function(){})}function d(){var e=t,o=r.search().item;if(void 0!==o)return parseInt(o);for(var n=0;n<e.courseCategory.length;n++)if(e.courseCategory[n]._id===e.secondCategoryId)return n}function p(){var e=t;C=new Swiper("#J_swiperHeader",{slidesPerView:3,spaceBetween:0,freeMode:!0,onInit:function(t){t.slideTo(e.activeIndex),a(function(){r.search("item",e.activeIndex)})},onTap:function(t){return e.activeIndex===t.clickedIndex?!1:(e.activeIndex=t.clickedIndex,void(e.pageConfig.loadingProcess||(e.pageConfig.start=1,e.pageConfig.loadingText="努力加载中...",e.pageConfig.showLoading=!0,e.pageConfig.hasNoData=!1,e.courseList=[],m(!0))))}})}function m(e){var o=t,e=e||!1;c.list({subcategoryId:o.courseCategory[o.activeIndex]._id,start:o.pageConfig.start,limit:o.pageConfig.limit,city:w.city,lon:w.lon,lat:w.lat,distance:20/111}).then(function(t){t&&t.data?(o.courseList=e?t.data:o.courseList.concat(t.data),o.pageConfig.loadingProcess=!1,o.pageConfig.showLoading=t.data.length<o.pageConfig.limit,o.pageConfig.hasNoData=t.data.length<o.pageConfig.limit,o.pageConfig.scrollAble=t.data.length===o.pageConfig.limit,o.pageConfig.scrollAble?o.pageConfig.loadingText="努力加载中...":o.pageConfig.loadingText="没有更多了..."):(o.pageConfig.showLoading=!0,o.pageConfig.loadingText="网络错误，请刷新再试...")},function(){})}function f(){var e=t;bannerHeight=angular.element("#J_banner").height(),win=window,body=document.body,$(win).bind("scroll",function(){a(win.scrollY>=bannerHeight?function(){e.view.navFixed=!0}:function(){e.view.navFixed=!1}),win.scrollY+win.innerHeight>=body.offsetHeight-60&&e.pageConfig.scrollAble&&!e.pageConfig.loadingProcess&&(e.pageConfig.loadingProcess=!0,e.pageConfig.showLoading=!0,e.pageConfig.start++,m())})}function h(){l.shareAppMessage({title:"翼起学本期精选课程",link:n.course+",course/list/"+i.firstCategoryId+"/"+i.secondCategoryId,desc:"翼起学本期精选的百个优质活动和课程，不多也不少",imgUrl:"http://cdn.4001583721.com/wx-course-share.png",success:function(){}}),l.shareTimeline({title:"翼起学本期精选课程",link:n.course+",course/list/"+i.firstCategoryId+"/"+i.secondCategoryId,imgUrl:"http://cdn.4001583721.com/wx-course-share.png",success:function(){}})}function v(){f(),wx.ready(function(){h()}),u()}var c=new c,C=null,w=s.location.get()||{lat:31.29607,lon:121.4961,city:"上海市"};t.view={navFixed:!1,imageNumber:""},t.pageConfig={start:1,limit:6,showLoading:!0,loadingText:"努力加载中...",loadingProcess:!0,scrollAble:!1,hasNoData:!1},t.secondCategoryId=i.secondCategoryId,t.courseCategory=[],t.courseList=[],t.selectCourse=g,t.activeIndex=0,t.$on("$destroy",function(){$(window).unbind("scroll")}),v()}])},function(e,t,o){var n=o(2);angular.module("YApp").controller("myCourseCtrl",["$rootScope","$scope","$state","$stateParams","$timeout","courseModel","campaignModel","toolsService","cacheService","wxsdkService",function(e,t,o,i,a,r,c,s,l,g){function u(){var e=t;1==e.listShow&&d(),2==e.listShow&&p(),3==e.listShow&&m()}function d(){var o=t;c.myCampaign({userId:l.userId.get(),limit:o.pageConfig.limit,start:o.pageConfig.start}).then(function(t){a(function(){e.pageLoading=!1}),t&&t.length>-1?(o.campaignOrder=o.pageConfig.loadingProcess?t:o.campaignOrder.concat(t),f(o.campaignOrder),o.pageConfig.loadingProcess=!1,o.pageConfig.showLoading=t.length<o.pageConfig.limit,o.pageConfig.hasNoData=t.length<o.pageConfig.limit,o.pageConfig.scrollAble=t.length===o.pageConfig.limit,o.pageConfig.scrollAble?o.pageConfig.loadingText="努力加载中...":o.pageConfig.loadingText="没有更多了~~"):(o.pageConfig.showLoading=!0,o.pageConfig.loadingText="网络错误，请刷新再试...")},function(){})}function p(){var o=t;r.userOrder({userId:l.userId.get(),limit:o.pageConfig.limit,start:o.pageConfig.start}).then(function(t){a(function(){e.pageLoading=!1}),t&&t.length>-1?(o.courseOrder=o.pageConfig.loadingProcess?t:o.courseOrder.concat(t),v(o.courseOrder),o.pageConfig.loadingProcess=!1,o.pageConfig.showLoading=t.length<o.pageConfig.limit,o.pageConfig.hasNoData=t.length<o.pageConfig.limit,o.pageConfig.scrollAble=t.length===o.pageConfig.limit,o.pageConfig.scrollAble?o.pageConfig.loadingText="努力加载中...":o.pageConfig.loadingText="没有更多了~~"):(o.pageConfig.showLoading=!0,o.pageConfig.loadingText="网络错误，请刷新再试...")},function(e){console.log(e)})}function m(){var e=t;r.userFavorite({userId:l.userId.get(),limit:e.pageConfig.limit,start:e.pageConfig.start}).then(function(t){t&&t.length>-1?(e.collect=e.pageConfig.loadingProcess?t:e.collect.concat(t),e.pageConfig.loadingProcess=!1,e.pageConfig.showLoading=t.length<e.pageConfig.limit,e.pageConfig.hasNoData=t.length<e.pageConfig.limit,e.pageConfig.scrollAble=t.length===e.pageConfig.limit,e.pageConfig.scrollAble?e.pageConfig.loadingText="努力加载中...":e.pageConfig.loadingText="没有更多了~~"):(e.pageConfig.showLoading=!0,e.pageConfig.loadingText="网络错误，请刷新再试...")},function(e){console.log(e)})}function f(e){for(var o=t,n=0;n<e.length;n++)1===e[n].trade.status&&(e[n].trade.over=0,moment().diff(moment(1e3*e[n].trade.created))>72e5?e[n].trade.over=0:e[n].trade.over=1);
a(function(){o.campaignOrder=e;window.setInterval(h,1e3)})}function h(){for(var e=t,o=[],n=(new Date).getTime(),n=parseInt(n/1e3),i=0;i<e.campaignOrder.length;i++){var a=7200-(n-e.campaignOrder[i].trade.created),r=parseInt(a/3600),c=parseInt(a%3600/60),s="未付款 请于"+r+"小时"+c+"分钟内完成付款";$(".campaignCountDown").find(".timer").eq(i).text(s),0>a&&(o.push(a),o.length<1&&window.clearInterval(campaignTimes))}}function v(e){for(var o=t,n=0;n<e.length;n++)1===e[n].trade.status&&(e[n].trade.over=0,moment().diff(moment(1e3*e[n].trade.created))>72e5?e[n].trade.over=0:e[n].trade.over=1);a(function(){o.courseOrder=e;window.setInterval(C,1e3)})}function C(){for(var e=t,o=[],n=(new Date).getTime(),n=parseInt(n/1e3),i=0;i<e.courseOrder.length;i++){var a=7200-(n-e.courseOrder[i].trade.created),r=parseInt(a/3600),c=parseInt(a%3600/60),s="未付款 请于"+r+"小时"+c+"分钟内完成付款";$(".courseCountDown").find(".timer").eq(i).text(s),0>a&&(o.push(a),o.length<1&&window.clearInterval(courseTimes))}}function w(){var e=t,o=window,n=document.body;$(o).bind("scroll",function(){o.scrollY+o.innerHeight>=n.offsetHeight-60&&e.pageConfig.scrollAble&&!e.pageConfig.loadingProcess&&(e.pageConfig.showLoading=!0,e.pageConfig.start++,u())})}function b(){g.shareAppMessage({title:"翼起学本期精选课程",link:n.course,desc:"翼起学本期精选的百个优质活动和课程，不多也不少",imgUrl:"http://cdn.4001583721.com/wx-course-share.png",success:function(){}}),g.shareTimeline({title:"翼起学本期精选课程",link:n.course,imgUrl:"http://cdn.4001583721.com/wx-course-share.png",success:function(){}})}function I(){w(),wx.ready(function(){b()}),u()}s.setTitleForIphone("我的课程");var c=new c,r=new r;a(function(){e.pageLoading=!1}),t.pageConfig={start:1,limit:5,showLoading:!0,loadingText:"努力加载中...",loadingProcess:!0,scrollAble:!1,hasNoData:!1},t.listShow=2,t.collect=[],t.courseOrder=[],t.campaignOrder=[],t.getList=function(e){var o=t;o.collect=[],o.courseOrder=[],o.campaignOrder=[],o.pageConfig.start=1,o.listShow=e,u()},t.$on("$destroy",function(){$(window).unbind("scroll")}),t.payAgain=function(e,t){"course"===t&&r.payAgain({_id:e.trade._id}).then(function(e){l.courseOrder.set(e),location=location.protocol+"//"+location.host+"/index.html#/common/pay/course",location.reload()},function(){}),"campaign"===t&&c.payAgain({_id:e.trade._id}).then(function(e){l.campaignOrder.set(e),location=location.protocol+"//"+location.host+"/index.html#/common/pay/campaign",location.reload()},function(){})},I()}])},function(e,t,o){var n=o(2);angular.module("YApp").controller("courseOrderCtrl",["$rootScope","$scope","$state","$stateParams","$timeout","cacheService","wxsdkService","courseModel","toolsService",function(e,t,o,i,a,r,c,s,l){function g(){var o=t;s.orderDetail({userId:r.userId.get(),classId:h.classId||h.order.classId}).then(function(t){o.classData=t.classData,o.courseData=t.courseData,e.pageLoading=!1,p=n.course+",course/detail/"+o.courseData._id+(m.isMember?","+f:""),wx.ready(function(){u()})},function(e){console.log(e)})}function u(){var e=t;c.shareAppMessage({title:e.courseData.name,link:p,desc:"翼起学本期精选的百个优质活动和课程，不多也不少",imgUrl:e.courseData.cover||"http://cdn.4001583721.com/wx-course-share.png",success:function(){}}),c.shareTimeline({title:e.courseData.name,link:p,imgUrl:e.courseData.cover||"http://cdn.4001583721.com/wx-course-share.png",success:function(){}})}function d(){g()}var p,s=new s,m=r.userInfo.get(),f=r.userId.get(),h=r.courseOrder.get();$("#J_courseOrderPage").css("minHeight",$(document.body)[0].scrollHeight),t.pageInfo={phone:h.mobile,name:"",sourceId:m.sourceId},l.setTitleForIphone("订单确认"),t.orderUp=function(){var e=t;return""==e.pageInfo.name?(alert("请填写参与人姓名"),!1):""==e.pageInfo.phone?(alert("请填写参与人手机号码"),!1):l.checkPhone(e.pageInfo.phone)?void s.order({name:e.pageInfo.name,userId:r.userId.get(),mobile:e.pageInfo.phone,classId:e.classData._id,sourceId:e.pageInfo.sourceId}).then(function(e){0===e.order.price?(alert("您已报名成功，报名详细信息已发送到您的手机上，谢谢"),o.go("course.myCourse")):(r.courseOrder.set(e),location=location.protocol+"//"+location.host+"/index.html#/common/pay/course",location.reload())},function(){alert("提交订单失败")}):(alert("请填写正确的手机号码"),!1)},t.$on("$destroy",function(){angular.element("body").css("height","auto")}),d()}])},function(e,t,o){var n=o(2);angular.module("YApp").controller("schoolCourseCtrl",["$rootScope","$scope","$state","$stateParams","$timeout","schoolModel","wxsdkService","toolsService","cacheService",function(e,t,o,i,a,r,c,s,l){function g(){var o=t;r.courseList({id:i.id,start:1,limit:99999,lon:p.lon,lat:p.lat}).then(function(t){a(function(){e.pageLoading=!1,s.setTitleForIphone("校区课程")}),o.courseList=t.data,o.dist=t.dist,o.schoolData=t.schoolData},function(e){console.log(e)})}function u(){var e=t;c.shareAppMessage({title:e.schoolData.name,link:n.course+",course/schoolDetail/"+i.id,desc:"翼起学本期精选的百个优质活动和课程，不多也不少",imgUrl:e.schoolData.logo||"http://cdn.4001583721.com/default_avatar1.png",success:function(){}}),c.shareTimeline({title:e.schoolData.name,link:n.course+",course/schoolDetail/"+i.id,imgUrl:e.schoolData.logo||"http://cdn.4001583721.com/default_avatar1.png",success:function(){}})}function d(){g(),wx.ready(function(){u()})}var r=new r,p=l.location.get()||{lat:31.29607,lon:121.4961,city:"上海市"};d()}])},function(e,t,o){var n=o(2);angular.module("YApp").controller("schoolDetailCtrl",["$rootScope","$scope","$state","$stateParams","$timeout","schoolModel","wxsdkService","toolsService","cacheService",function(e,t,o,i,a,r,c,s,l){function g(){var o=t;r.detail({id:i.id}).then(function(t){e.pageLoading=!1,o.school=t,o.school.comment=o.school.comment.reverse(),s.setTitleForIphone("校区详情"),d()},function(){})}function u(){var e=t;c.previewImage({current:e.school.companyImage})}function d(){var e=t;c.shareAppMessage({title:e.school.name,link:n.course+",course/schoolDetail/"+i.id,desc:"翼起学本期精选的百个优质活动和课程，不多也不少",imgUrl:e.school.logo||"http://cdn.4001583721.com/default_avatar1.png",success:function(){}}),c.shareTimeline({title:e.school.name,link:n.course+",course/schoolDetail/"+i.id,imgUrl:e.school.logo||"http://cdn.4001583721.com/default_avatar1.png",success:function(){}})}function p(){window.scrollTo(0,0),g()}var r=new r;t.pageView={companyShow:!1,commentEditing:!1,content:""},t.initPreview=u,t.openLocation=function(){var e=t;c.openLocation({lat:e.school.location[1],lon:e.school.location[0],name:e.school.name,address:e.school.address})},t.addComment=function(){var e=t;e.pageView.commentEditing=!0},t.sendComment=function(){var e=t;return e.pageView.content?void r.evaluate({schoolId:i.id,creator:l.userId.get(),content:e.pageView.content}).then(function(t){t&&t.success&&(e.pageView.content="",e.school.comment.unshift(t.data),$(window).scrollTop($("#J_commentWraper").offset().top-20),a(function(){e.pageView.commentEditing=!1}))},function(){}):!1},t.openSchoolCourse=function(){var e=t;return e.school.courseCount>0?void o.go("course.schoolCourse",{id:e.school._id}):!1},p()}])},function(e,t,o){var n=o(2);angular.module("YApp").controller("distributionCenterCtrl",["$rootScope","$scope","$state","$stateParams","$timeout","$location","distributionModel","cacheService","wxsdkService","toolsService",function(e,t,o,i,a,r,c,s,l,g){function u(){var o=t;c.centerDetail({userId:h}).then(function(t){t&&(o.centerDetail=t,e.pageLoading=!1)},function(e){console.log(e)})}function d(){var o=t;c.centerList({type:o.pageConfig.listType}).then(function(t){t&&(o.centerList=t.data,e.pageLoading=!1)},function(e){console.log(e)})}function p(){l.shareAppMessage({title:"翼起学为孩子们安排好暑期行程",link:v,desc:C,imgUrl:"http://cdn.4001583721.com/share-distribution-icon03.png",success:function(){}}),l.shareTimeline({title:"翼起学为孩子们安排好暑期行程",link:v,imgUrl:"http://cdn.4001583721.com/share-distribution-icon03.png",success:function(){}})}function m(){wx.ready(function(){p()}),f.type>=1?(u(),d(),e.pageLoading=!1):e.pageLoading=!1}var f=s.userInfo.get(),h=s.userId.get(),c=new c,v=f.isMember?n.distribution+",distribution/index,"+h:n.distribution,C="有了翼起学暑期小特工，您至少可以休息两个月。";g.setTitleForIphone("我的收入记录"),$("#J_distributionCenter").css("minHeight",$(document.body)[0].scrollHeight),t.userInfo=f,t.centerDetail={},t.centerList={},t.pageConfig={listType:1},t.goSale=function(e){o.go("distribution.sale",{type:e})},t.getList=function(e){var o=t;o.pageConfig.listType=e,d()},m()}])},function(e,t,o){var n=o(2);angular.module("YApp").controller("distributionGroupCtrl",["$rootScope","$scope","$state","$stateParams","$timeout","$location","cacheService","wxsdkService","toolsService","distributionModel",function(e,t,o,i,a,r,c,s,l,g){function u(){s.shareAppMessage({title:"翼起学为孩子们安排好暑期行程",link:h,desc:m,imgUrl:"http://cdn.4001583721.com/share-distribution-icon03.png",success:function(){}}),s.shareTimeline({title:"翼起学为孩子们安排好暑期行程",link:h,imgUrl:"http://cdn.4001583721.com/share-distribution-icon03.png",success:function(){}})}function d(e){g.getSort({userId:f}).then(function(t){t&&e&&e(t)},function(e){console.log(e)})}function p(){wx.ready(function(){d(function(e){m="有了翼起学暑期小特工，您至少可以休息两个月。",u(),c.userInfo.set(angular.extend(c.userInfo.get(),{isMember:1,sort:e.sort}))})})}var m,g=new g,f=(c.userInfo.get(),c.userId.get()),h=n.distribution+",distribution/index,"+f;l.setTitleForIphone("购买成功"),$("#J_distributionGroup").css("minHeight",$(document.body)[0].scrollHeight),e.pageLoading=!1,e.isPageCover=!0,t.shareLink=h,t.centerLink=n.distributionCenter,p()}])},function(e,t,o){o(2);angular.module("YApp").controller("distributionHelpCtrl",["$rootScope","$scope","$state","$stateParams","$timeout","$location","cacheService","wxsdkService","toolsService","distributionModel",function(e,t,o,n,i,a,r,c,s,l){function g(e){var o=t;o.pageConfig.pageView=e,o.pageConfig.imageView=1}function u(){}var l=new l;$("#J_distributionHelpPage").css("minHeight",$(document.body)[0].scrollHeight),t.pageConfig={pageView:0,imageView:1},s.setTitleForIphone("翼起学"),e.pageLoading=!1,e.isPageCover=!1,t.pageView=g,u()}])},function(e,t,o){o(124),o(128),o(121),o(120),o(126),o(127),o(125),o(122)},function(e,t,o){var n=o(2);angular.module("YApp").controller("distributionIndexPageCtrl",["$rootScope","$scope","$state","$stateParams","$timeout","$location","distributionModel","cacheService","wxsdkService","toolsService",function(e,t,o,i,a,r,c,s,l,g){function u(){l.shareAppMessage({title:"翼起学为孩子们安排好暑期行程",link:v,desc:C,imgUrl:"http://cdn.4001583721.com/share-distribution-icon03.png",success:function(){}}),l.shareTimeline({title:"翼起学为孩子们安排好暑期行程",link:v,imgUrl:"http://cdn.4001583721.com/share-distribution-icon03.png",success:function(){}})}function d(){var e=t;c.memberInfo({start:e.pageConfig.start,limit:e.pageConfig.limit}).then(function(t){e.memberInfoList=t},function(e){console.log(e)})}function p(e){l.previewImage({current:e})}function m(){wx.ready(function(){u()}),d()}var c=new c,f=s.userInfo.get(),h=s.userId.get(),v=f.isMember?n.distribution+",distribution/index,"+h:n.distribution,C="有了翼起学暑期小特工，您至少可以休息两个月。";g.setTitleForIphone("会员亲子年卡限时拼团中"),$("#J_distributionIndexPage").css("minHeight",$(document.body)[0].scrollHeight),e.pageLoading=!1,t.userInfo=f,t.shareLink=v,t.link=n,t.initPreview=p,t.memberInfoList=[],t.pageConfig={start:1,limit:35},m()}])},function(e,t,o){var n=o(2);angular.module("YApp").controller("distributionPrincipalCtrl",["$rootScope","$scope","$state","$stateParams","$timeout","$location","distributionModel","cacheService","wxsdkService","toolsService",function(e,t,o,i,a,r,c,s,l,g){function u(){l.shareAppMessage({title:"国民老公邀请您一起学一起玩！",link:h,desc:v,imgUrl:"http://cdn.4001583721.com/share-distribution-icon.png",success:function(){}}),l.shareTimeline({title:"国民老公邀请您一起学一起玩！",link:h,imgUrl:"http://cdn.4001583721.com/share-distribution-icon.png",success:function(){}})}function d(){$(window).bind("scroll",function(){var e=t,o=$(window).scrollTop();a(o>0?function(){e.pageConfig.buttonView=!0}:function(){e.pageConfig.buttonView=!1})})}function p(){wx.ready(function(){u()}),d()}var c=new c,m=s.userInfo.get(),f=s.userId.get(),h=m.isMember?n.distributionPrincipal+",distribution/principal,"+f:n.distributionPrincipal,v=m.sort>0?"我已是翼起学第"+m.sort+"位合伙人，前方高能预警，育儿福利太多接不住！":"前方高能预警，育儿福利太多接不住！";g.setTitleForIphone("战略合伙人招募中"),$("#J_distrbutionProducts").css("minHeight",$(document.body)[0].scrollHeight),e.pageLoading=!1,e.isPageCover=!1,e.isPageWhite=!0,t.userInfo=m,t.pageConfig={type:3,buttonView:!1},p()}])},function(e,t,o){var n=o(2),i=o(3);angular.module("YApp").controller("distributionProductsCtrl",["$rootScope","$scope","$state","$stateParams","$timeout","$location","distributionModel","cacheService","wxsdkService","toolsService",function(e,t,o,a,r,c,s,l,g,u){function d(e){for(var o=t,n=0;n<e.length;n++){o.price=[];for(var i=0;i<e[n]["class"].length;i++)1==e[n]["class"][i].type&&o.price.push(e[n]["class"][i].price*e[n]["class"][i].discount/100),2==e[n]["class"][i].type&&o.price.push(e[n]["class"][i].audition);o.courseList[n].maxPrice=parseInt(Math.max.apply(Math,o.price)),o.courseList[n].minPrice=parseInt(Math.min.apply(Math,o.price))}}function p(e){var o=t;o.reset=e||!1,1==o.pageConfig.listType&&s.productList({start:o.pageConfig.start,limit:o.pageConfig.limit,type:o.pageConfig.listType}).then(function(e){e&&e.data?(o.list=o.reset?e.data:o.list.concat(e.data),o.pageConfig.loadingProcess=!1,o.pageConfig.showLoading=e.data.length<o.pageConfig.limit,o.pageConfig.hasNoData=e.data.length<o.pageConfig.limit,o.pageConfig.scrollAble=e.data.length===o.pageConfig.limit,o.pageConfig.scrollAble?o.pageConfig.loadingText="努力加载中...":o.pageConfig.loadingText="没有更多了..."):(o.pageConfig.showLoading=!0,o.pageConfig.loadingText="网络错误，请刷新再试...")},function(e){console.log(e)}),2==o.pageConfig.listType&&s.courseList({start:o.pageConfig.start,limit:o.pageConfig.limit,id:i.courseCategoryId}).then(function(e){e&&e.data?(o.courseList=o.reset?e.data:o.courseList.concat(e.data),o.pageConfig.loadingProcess=!1,o.pageConfig.showLoading=e.data.length<o.pageConfig.limit,o.pageConfig.hasNoData=e.data.length<o.pageConfig.limit,o.pageConfig.scrollAble=e.data.length===o.pageConfig.limit,d(o.courseList),o.pageConfig.scrollAble?o.pageConfig.loadingText="努力加载中...":o.pageConfig.loadingText="没有更多了..."):(o.pageConfig.showLoading=!0,o.pageConfig.loadingText="网络错误，请刷新再试...")},function(e){console.log(e)}),3==o.pageConfig.listType&&s.campaignList({start:o.pageConfig.pageNumber,limit:o.pageConfig.limit,id:i.wechatId}).then(function(e){e&&e.total>-1?(o.campaignList=1==o.pageConfig.pageNumber?e.data:o.campaignList.concat(e.data),o.pageConfig.loadingProcess=!1,o.pageConfig.showLoading=e.total<o.pageConfig.limit,o.pageConfig.scrollAble=e.total>o.pageConfig.limit||e.total==o.pageConfig.limit,o.pageConfig.pageNumber==e.cPage?o.pageConfig.pageNumber+=1:o.pageConfig.pageNumber=e.cPage,o.pageConfig.scrollAble?o.pageConfig.loadingText="努力加载中...":o.pageConfig.loadingText="没有更多了..."):(o.pageConfig.showLoading=!0,o.pageConfig.loadingText="网络错误，请刷新再试...")},function(e){console.log(e)})}function m(){var e=t,o=window,n=document.body;$(o).bind("scroll",function(){o.scrollY+o.innerHeight>=n.offsetHeight-60&&e.pageConfig.scrollAble&&!e.pageConfig.loadingProcess&&(e.pageConfig.loadingProcess=!0,e.pageConfig.showLoading=!0,e.pageConfig.start++,p())})}function f(){g.shareAppMessage({title:"翼起学为孩子们安排好暑期行程",link:w,desc:b,imgUrl:"http://cdn.4001583721.com/share-distribution-icon03.png",success:function(){}}),g.shareTimeline({title:"翼起学为孩子们安排好暑期行程",link:w,imgUrl:"http://cdn.4001583721.com/share-distribution-icon03.png",success:function(){}})}function h(){wx.ready(function(){f()}),p(),m()}var s=new s,v=l.userInfo.get(),C=l.userId.get(),w=v.isMember?n.distribution+",distribution/index,"+C:n.distribution,b="有了翼起学暑期小特工，您至少可以休息两个月。";u.setTitleForIphone("推广产品"),$("#J_distrbutionProducts").css("minHeight",$(document.body)[0].scrollHeight),e.pageLoading=!1,e.isPageCover=!1,e.isPageWhite=!0,t.userInfo=v,t.pageConfig={listType:1,pageNumber:1,start:1,limit:4,showLoading:!0,loadingText:"努力加载中...",loadingProcess:!0,scrollAble:!1,hasNoData:!1},t.goNewPages=function(e){var n=t;1==n.pageConfig.listType&&(1===e?o.go("distribution.index"):o.go("distribution.principal")),2==n.pageConfig.listType&&o.go("course.detail",{id:e}),3==n.pageConfig.listType&&o.go("campaign.detail",{id:e})},t.list=[],t.campaignList=[],t.courseList=[],t.updateList=function(e){var o=t;o.list=[],o.pageConfig.pageNumber=1,o.pageConfig.listType=e,o.pageConfig.loadingProcess=!0,o.pageConfig.start=1,o.pageConfig.loadingText="努力加载中...",o.pageConfig.showLoading=!0,o.pageConfig.hasNoData=!1,p(!0)},t.$on("$destroy",function(){$(window).unbind("scroll")}),h()}])},function(e,t,o){var n=o(2);angular.module("YApp").controller("distributionSaleCtrl",["$rootScope","$scope","$state","$stateParams","$timeout","$location","distributionModel","cacheService","wxsdkService","toolsService",function(e,t,o,i,a,r,c,s,l,g){function u(){var e=t;c.saleList({start:e.pageConfig.start,limit:e.pageConfig.limit,type:e.pageConfig.listType,userId:h}).then(function(t){t&&t.data?(e.list=e.pageConfig.loadingProcess?t.data:e.list.concat(t.data),e.pageConfig.loadingProcess=!1,e.pageConfig.showLoading=t.data.length<e.pageConfig.limit,e.pageConfig.hasNoData=t.data.length<e.pageConfig.limit,e.pageConfig.scrollAble=t.data.length===e.pageConfig.limit,e.pageConfig.scrollAble?e.pageConfig.loadingText="努力加载中...":e.pageConfig.loadingText="没有更多了..."):(e.pageConfig.showLoading=!0,e.pageConfig.loadingText="网络错误，请刷新再试...")},function(e){console.log(e)})}function d(){var e=t,o=window,n=document.body;$(o).bind("scroll",function(){o.scrollY+o.innerHeight>=n.offsetHeight-60&&e.pageConfig.scrollAble&&!e.pageConfig.loadingProcess&&(e.pageConfig.showLoading=!0,e.pageConfig.start++,u())})}function p(){l.shareAppMessage({title:"翼起学为孩子们安排好暑期行程",link:v,desc:C,imgUrl:"http://cdn.4001583721.com/share-distribution-icon03.png",success:function(){}}),l.shareTimeline({title:"翼起学为孩子们安排好暑期行程",link:v,imgUrl:"http://cdn.4001583721.com/share-distribution-icon03.png",success:function(){}})}function m(){var e=t;wx.ready(function(){p()}),i.type?e.pageConfig.listType=i.type:e.pageConfig.listType=1,u(),d()}var c=new c,f=s.userInfo.get(),h=s.userId.get(),v=f.isMember?n.distribution+",distribution/index,"+h:n.distribution,C="有了翼起学暑期小特工，您至少可以休息两个月。";g.setTitleForIphone("我的销售记录"),$("#J_distrbutionProducts").css("minHeight",$(document.body)[0].scrollHeight),e.pageLoading=!1,e.isPageCover=!1,t.pageConfig={listType:1,start:1,limit:5,showLoading:!0,loadingText:"努力加载中...",loadingProcess:!0,scrollAble:!1,hasNoData:!1},t.goNewPages=function(e){var n=t;1==n.pageConfig.listType&&o.go("distribution.index"),2==n.pageConfig.listType&&o.go("campaign.detail",{id:e}),3==n.pageConfig.listType&&o.go("course.detail",{id:e})},t.list=[],t.updateList=function(e){var o=t;o.list=[],o.pageConfig.listType=e,o.pageConfig.loadingProcess=!0,o.pageConfig.start=1,o.pageConfig.loadingText="努力加载中...",o.pageConfig.showLoading=!0,o.pageConfig.hasNoData=!1,u()},t.$on("$destroy",function(){$(window).unbind("scroll")}),m()}])},function(e,t,o){var n=o(2);angular.module("YApp").controller("distributionSingupCtrl",["$rootScope","$scope","$state","$stateParams","$timeout","$interval","wxsdkService","cacheService","toolsService","distributionModel","courseModel",function(e,t,o,i,a,r,c,s,l,g,u){function d(e){var o=t;o.tipView.show=!0,o.tipView.text=e,a(function(){o.tipView.show=!1,o.tipView.text=""},2e3)}function p(){var e,o=t,n=60;return o.code.sended?!1:void u.sendPhoneMsg({mobile:o.order.mobile}).then(function(t){t&&0===t.errcode?(o.code.sended=!0,e=r(function(){o.code.timerText=n--,-1===n&&(r.cancel(e),o.code.sended=!1,o.code.timerText="重发")},1e3)):(d("短信发送失败，请重发"),o.code.sended=!1,o.code.timerText="重发")})}function m(){var e=t;u.verificationCode({mobile:e.order.mobile,code:e.code.value}).then(function(e){e&&0===e.errcode?f():d("验证码错误")})}function f(){var e=t;e.saveStatus.text="报名中...",e.saveStatus.loading=!0,g.order(e.order).then(function(e){return e&&"ProtocolError"===e.name?(alert("微信协议错误，暂不能支付，请联系管理员"),!1):(s.distributionOrder.set(e),location=location.protocol+"//"+location.host+"/index.html#/common/pay/distribution",void location.reload())},function(){alert("提交订单失败")})}function h(e){var o=t;return e.$invalid||o.saveStatus.loading?!1:void m()}function v(){c.shareAppMessage({title:"翼起学为孩子们安排好暑期行程",link:n.distribution,desc:"有了翼起学暑期小特工，您至少可以休息两个月。",imgUrl:"http://cdn.4001583721.com/share-distribution-icon03.png",success:function(){}}),c.shareTimeline({title:"翼起学为孩子们安排好暑期行程",link:n.distribution,imgUrl:"http://cdn.4001583721.com/share-distribution-icon03.png",success:function(){}})}function C(){wx.ready(function(){v()})}var g=new g,u=new u,w=s.userInfo.get();s.userId.get();l.setTitleForIphone("填写个人信息"),e.pageLoading=!1,t.order={userId:s.userId.get(),mobile:"",name:"",type:parseInt(i.type)>=3?parseInt(i.type):2,sourceId:w.sourceId},t.code={sended:!1,timerText:"发送",value:""},t.tipView={show:!1,text:""},t.saveStatus={text:"确认报名",loading:!1},t.singup=h,t.sendCode=p,C()}])},function(e,t,o){o(108),o(103),o(114),o(123)},function(e,t){angular.module("YApp").directive("autoFocus",function(){return{restrict:"A",link:function(e,t,o){e.$watch(function(){return e.$eval(o.autoFocus)},function(e){e===!0&&t[0].focus()})}}})},function(e,t){angular.module("YApp").directive("ngDistributionDialog",["$state",function(e){return{restrict:"A",link:function(t,o,n){var i=n.qrCodeUrl,a="J_distribution_"+Math.floor(9999*Math.random()),r='<div class="distribution-spread" id="'+a+'"><div class="spread-model"><h4 class="title">立即推广</h4><div class="desc-section"><p class="name">方法一：微信内直接分享</p><p class="content">点击微信右上角，通过【发送给朋友】或【分享到朋友圈】推广</p></div><div class="desc-section J_way"><p class="name">方法二：使用专属二维码推广</p><p class="content" style="width:70%;">点击右侧二维码放大，邀请客户扫描即可</p><p class="code-img" id="J_qrCodeWraper"></p></div><div class="button-wraper"><button class="c-distribution-button c-distribution-button-fill J_goCenter" href="/index.html#/distribution/center">返回会员中心</button><button class="c-distribution-button J_close">关闭</button></div></div></div>';o.bind("click",function(){var t;angular.element("body").append(angular.element(r)),r=angular.element("#"+a),t=$("#J_qrCodeWraper"),t.html(""),t.qrcode({text:i,width:.75*r.width(),height:.75*r.width()}),r.find(".J_close").click(function(e){t.css({width:"20%",right:"0px"}).appendTo(r.find(".J_way")),r.remove()}),r.find(".J_goCenter").click(function(o){t.css({width:"20%",right:"0px"}).appendTo(r.find(".J_way")),r.remove(),e.go("distribution.center")}),r.find("#J_qrCodeWraper").click(function(e){t.css({width:"90%",right:"5%",top:"0.3rem",position:"absolute","text-align":"center",background:"#fff"}).appendTo(r.find(".spread-model"))})})}}}])},function(e,t,o){o(130),o(131)},function(e,t){angular.module("YApp").filter("phone",["$sce",function(e){return function(t){return e.trustAsHtml(t.replace(/,/g,"<br/>"))}}]),angular.module("YApp").filter("html",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]),angular.module("YApp").filter("trusted",["$sce",function(e){return function(t){return e.trustAsResourceUrl(t)}}]),angular.module("YApp").filter("mdate",function(){return function(e,t){return moment.unix(e).format(t)}}),angular.module("YApp").filter("clearSpace",function(){return function(e){return e.replace(/\s+/g,"")}}),angular.module("YApp").filter("distance",function(){return function(e){return 1e3>e?parseInt(e)+"m":parseFloat(e/1e3).toFixed(2)+"km"}})},function(e,t,o){var n=o(3);angular.module("YApp").factory("campaignModel",["httpService",function(e){var t=function(){};return t.prototype={sendPhoneMsg:function(t){var t=t||{};return t=angular.extend({method:"com.deer.sms.sendSms"},t),e.request(n.campaign,"GET",t)},verificationCode:function(t){var t=t||{};return t=angular.extend({method:"com.deer.sms.checkCode"},t),e.request(n.campaign,"POST",t)},hostList:function(t){var t=t||{};return t=angular.extend({method:"com.event.channel.campaign.list"},t),e.request(n.campaign,"GET",t)},recommendList:function(t){var t=t||{};return t=angular.extend({method:"com.event.channel.campaign.recommend"},t),e.request(n.campaign,"GET",t)},nearList:function(t){var t=t||{};return t=angular.extend({method:"com.event.channel.campaign.nearby"},t),e.request(n.campaign,"GET",t)},detail:function(t){var t=t||{};return t=angular.extend({method:"com.event.channel.campaign.get"},t),e.request(n.campaign,"GET",t)},order:function(t){var t=t||{};return t=angular.extend({method:"com.event.channel.campaign.order"},t),e.request(n.campaign,"POST",t)},payAgain:function(t){var t=t||{};return t=angular.extend({method:"com.event.channel.campaign.againPay"},t),e.request(n.campaign,"GET",t)},myCampaign:function(t){var t=t||{};return t=angular.extend({method:"com.event.channel.campaign.userOrder"},t),e.request(n.campaign,"GET",t)},ticketList:function(t){var t=t||{};return t=angular.extend({method:"com.deer.eTicket.list"},t),e.request(n.campaign,"GET",t)},questionList:function(t){var t=t||{};return t=angular.extend({method:"com.deer.question.list"},t),e.request(n.campaign,"GET",t)}},t}])},function(e,t,o){var n=o(3);angular.module("YApp").factory("courseModel",["httpService",function(e){var t=function(){};return t.prototype={sendPhoneMsg:function(t){var t=t||{};return t=angular.extend({method:"com.deer.sms.sendSms"},t),e.request(n.course,"GET",t)},verificationCode:function(t){var t=t||{};return t=angular.extend({method:"com.deer.sms.checkCode"},t),e.request(n.course,"POST",t)},detail:function(t){var t=t||{};return t=angular.extend({method:"com.deer.course.get"},t),e.request(n.course,"GET",t)},collect:function(t){var t=t||{};return t=angular.extend({method:"com.deer.favorite.saveOrUpdate"},t),e.request(n.course,"POST",t)},categoryList:function(t){var t=t||{};return t=angular.extend({method:"com.deer.category.list"},t),e.request(n.course,"GET",t)},list:function(t){var t=t||{};return t=angular.extend({method:"com.deer.course.list"},t),e.request(n.course,"GET",t)},orderDetail:function(t){var t=t||{};return t=angular.extend({method:"com.deer.course.detail"},t),e.request(n.course,"GET",t)},order:function(t){var t=t||{};return t=angular.extend({method:"com.deer.course.order"},t),e.request(n.course,"POST",t)},userOrder:function(t){var t=t||{};return t=angular.extend({method:"com.deer.course.userOrder"},t),e.request(n.course,"GET",t)},userFavorite:function(t){var t=t||{};return t=angular.extend({method:"com.deer.favorite.userFavorite"},t),e.request(n.course,"GET",t)},payAgain:function(t){var t=t||{};return t=angular.extend({method:"com.deer.course.againPay"},t),e.request(n.course,"GET",t)}},t}])},function(e,t,o){var n=o(3);angular.module("YApp").factory("distributionModel",["httpService",function(e){var t=function(){};return t.prototype={order:function(t){var t=t||{};return t=angular.extend({method:"com.deer.member.order"},t),e.request(n.distribution,"POST",t)},centerDetail:function(t){var t=t||{};return t=angular.extend({method:"com.deer.member.getEarnDetail"},t),e.request(n.distribution,"GET",t)},centerList:function(t){var t=t||{};return t=angular.extend({method:"com.deer.member.list"},t),e.request(n.distribution,"GET",t)},productList:function(t){var t=t||{};return t=angular.extend({method:"com.deer.member.salesProduct"},t),e.request(n.distribution,"GET",t)},saleList:function(t){var t=t||{};return t=angular.extend({method:"com.deer.member.salesHistory"},t),e.request(n.distribution,"GET",t)},getSort:function(t){var t=t||{};return t=angular.extend({method:"com.deer.member.numberSort"},t),e.request(n.distribution,"GET",t)},courseList:function(t){var t=t||{};return t=angular.extend({method:"com.deer.income.course"},t),e.request(n.distribution,"GET",t)},campaignList:function(t){var t=t||{};return t=angular.extend({method:"com.deer.income.campaign"},t),e.request(n.distribution,"GET",t)},memberInfo:function(t){var t=t||{};return t=angular.extend({method:"com.deer.member.memberInfo"},t),e.request(n.distribution,"GET",t)}},t}])},function(e,t){angular.module("YApp").factory("httpService",["$http","$q",function(e,t){return{request:function(o,n,i,a){var r=t.defer(),a=a||{},c={url:o,method:n},s={version:"1.1",format:"json",language:"zh_CN"};return c.headers=a,i&&angular.isObject(i)?"GET"===n?c.params=angular.extend(s,i):c.data=angular.extend(s,i):i&&angular.isString(i)&&("GET"===n?c.params=i:c.data=i),e(c).success(function(e){r.resolve(e)}).error(function(e){r.reject(e)}),r.promise}}}])},function(e,t,o){o(137),o(134),o(135),o(139),o(136)},function(e,t,o){var n=o(3);angular.module("YApp").factory("schoolModel",["httpService",function(e){var t=function(){};return t.prototype={detail:function(t){var t=t||{};return t=angular.extend({method:"com.deer.school.get"},t),e.request(n.school,"GET",t)},evaluate:function(t){var t=t||{};return t=angular.extend({method:"com.deer.evaluate.save"},t),e.request(n.school,"POST",t)},courseList:function(t){var t=t||{};return t=angular.extend({method:"com.deer.course.slist"},t),e.request(n.school,"GET",t)}},t}])},function(e,t){angular.module("YApp").config(["$stateProvider","$urlRouterProvider","$locationProvider","MODULE_CONFIG","JQ_CONFIG",function(e,t,o,n,i){function a(e,t){return{deps:["$ocLazyLoad","$q",function(o,a){var r=a.defer(),c=!1;return e=angular.isArray(e)?e:e.split(/\s+/),c||(c=r.promise),angular.forEach(e,function(e){c=c.then(function(){return i[e]?o.load(i[e]):(angular.forEach(n,function(t){t.name==e?name=t.name:name=e}),o.load(name))})}),r.resolve(),t?c.then(function(){return t()}):c}]}}var r="./js/tpl/";t.otherwise("/wechatError"),e.state("wechatError",{url:"/wechatError",templateUrl:r+"common/wechatError.html"}).state("campaign",{"abstract":!0,url:"/campaign",templateUrl:r+"campaign/layout.html"}).state("campaign.list",{url:"/list/:id",templateUrl:r+"campaign/list.html"}).state("campaign.detail",{url:"/detail/:id",templateUrl:r+"campaign/detail.html",resolve:a(["jquery-qrcode"])}).state("campaign.myCampaign",{url:"/myCampaign",templateUrl:r+"campaign/myCampaign.html"}).state("order",{url:"/order",templateUrl:r+"campaign/order.html"}).state("campaign.question",{url:"/question",templateUrl:r+"campaign/question.html"}).state("course",{"abstract":!0,url:"/course",templateUrl:r+"course/layout.html"}).state("course.index",{url:"/index/:id",templateUrl:r+"course/home.html"}).state("course.list",{url:"/list/:firstCategoryId/:secondCategoryId",templateUrl:r+"course/list.html",resolve:a(["swiper"])}).state("course.detail",{url:"/detail/:id",templateUrl:r+"course/detail.html",resolve:a(["video-js","jquery-qrcode"])}).state("course.setPhone",{url:"/setPhone/:id",templateUrl:r+"course/setPhone.html"}).state("course.order",{url:"/order",templateUrl:r+"course/order.html"}).state("course.pay",{url:"/pay/:id",templateUrl:r+"course/pay.html"}).state("course.myCourse",{url:"/myCourse",templateUrl:r+"course/myCourse.html"}).state("course.schoolDetail",{url:"/schoolDetail/:id",templateUrl:r+"course/schoolDetail.html"}).state("course.schoolCourse",{url:"/schoolCourse/:id",templateUrl:r+"course/schoolCourse.html"}).state("distribution",{"abstract":!0,url:"/distribution",template:"<div ui-view></div>"}).state("distribution.index",{url:"/index",templateUrl:r+"distribution/index.html",resolve:a(["jquery-qrcode"])}).state("distribution.singup",{url:"/singup/:type",templateUrl:r+"distribution/singup.html"}).state("distribution.group",{url:"/group",templateUrl:r+"distribution/group.html",resolve:a(["jquery-qrcode"])}).state("distribution.center",{url:"/center",templateUrl:r+"distribution/center.html"}).state("distribution.products",{url:"/products",templateUrl:r+"distribution/products.html"}).state("distribution.sale",{url:"/sale/:type",templateUrl:r+"distribution/sale.html"}).state("distribution.principal",{url:"/principal",templateUrl:r+"distribution/principal.html"}).state("distribution.help",{url:"/help",templateUrl:r+"distribution/help.html"}).state("common",{"abstract":!0,url:"/common",template:'<div ui-view style="height:100%"></div>'}).state("common.setPhone",{url:"/setPhone/:type",templateUrl:r+"common/setPhone.html"}).state("common.pay",{url:"/pay/:type",templateUrl:r+"common/pay.html"})}])},function(e,t){
angular.module("YApp").factory("aMapService",["$rootScope",function(e){return{showEasyLocation:function(e){var t,o,n={};e=angular.extend(n,e),t=new AMap.Map(e.container,{zoom:50,center:e.location,dragEnable:!0,zoomEnable:!0}),o=new AMap.Marker({map:t,position:e.location})},getAddress:function(e,t){AMap.service("AMap.Geocoder",function(){geocoder=new AMap.Geocoder,geocoder.getAddress(e,function(e,o){"complete"===e&&"OK"===o.info?t&&t(o.regeocode):alert("获取城市地理位置信息失败，请刷新重试")})})}}}])},function(e,t){angular.module("YApp").factory("cacheService",["localStorageService",function(e){return{isSupported:function(){return e.isSupported},location:{set:function(t){e.set("location",t)},get:function(){return e.get("location")},remove:function(){e.remove("location")}},userId:{set:function(t){e.set("userId",t)},get:function(){return e.get("userId")},remove:function(){e.remove("userId")}},activityId:{set:function(t){e.set("activityId",t)},get:function(){return e.get("activityId")},remove:function(){e.remove("activityId")}},campaignOrder:{set:function(t){e.set("campaignOrder",t)},get:function(){return e.get("campaignOrder")},remove:function(){e.remove("campaignOrder")}},courseOrder:{set:function(t){e.set("courseOrder",t)},get:function(){return e.get("courseOrder")},remove:function(){e.remove("courseOrder")}},distributionOrder:{set:function(t){e.set("distributionOrder",t)},get:function(){return e.get("distributionOrder")},remove:function(){e.remove("distributionOrder")}},userInfo:{set:function(t){e.set("userInfo",t)},get:function(){return e.get("userInfo")},remove:function(){e.remove("userInfo")}}}}])},function(e,t,o){o(145),o(142),o(144),o(141)},function(e,t){angular.module("YApp").factory("toolsService",["$rootScope",function(e){return{isWechat:function(){var e=navigator.userAgent.toLowerCase();return"micromessenger"==e.match(/MicroMessenger/i)},checkPhone:function(e){return/^(13[0-9]|15[0-9]|17[0-9]|18[0-9]|14[0-9])[0-9]{8}$/.test(e)},getUrlParam:function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t="[\\?&]"+e+"=([^&#]*)",o=new RegExp(t),n=o.exec(window.location.hash);return null==n?"":decodeURIComponent(n[1].replace(/\+/g," "))},setTitleForIphone:function(e){$("title").text(e);var t=$('<iframe src="/favicon.ico" style="display:none"></iframe>');t.on("load",function(){setTimeout(function(){t.off("load").remove()},0)}).appendTo($("body"))},fixBodyHeight:function(){angular.element("body").height(angular.element("html")[0].offsetHeight)},calculationCountdown:function(e){var t,o,n,i,e=parseInt(e,10),a=parseInt((new Date).getTime()/1e3,10);return a>=e?!1:(e-=a,t=parseInt(e/86400,10),o=parseInt(e%86400/3600,10),n=parseInt(e%86400%3600/60,10),i=parseInt(e%86400%3600%60,10),[t,o,10>n?"0"+n:n,10>i?"0"+i:i])}}}])},function(e,t,o){var n=o(3);angular.module("YApp").factory("wxsdkService",["httpService","cacheService",function(e,t){return{init:function(o){var o=o||{};return o=angular.extend({method:"com.wechat.config.jssdk.init",activityId:t.activityId.get(),url:window.location.href.split("#")[0]},o),e.request(n.campaign,"GET",o)},getLocation:function(e){wx.getLocation({type:"wgs84",success:function(t){e&&e(t)}})},openLocation:function(e){wx.openLocation({latitude:e.lat,longitude:e.lon,name:e.name||"",address:e.address||"",scale:e.scale||20,infoUrl:e.infoUrl||""})},shareAppMessage:function(e){wx.onMenuShareAppMessage({title:e.title,link:e.link,imgUrl:e.imgUrl,desc:e.desc,type:"link",dataUrl:"",success:function(){e.success&&e.success()},cancel:function(t){e.cancel&&e.cancel()}})},shareTimeline:function(e){wx.onMenuShareTimeline({title:e.title,link:e.link,imgUrl:e.imgUrl,success:function(){e.success&&e.success()},cancel:function(){e.cancel&&e.cancel()}})},previewImage:function(e){wx.previewImage({current:e.current,urls:e.urls||[e.current]})}}}])},,,,,,,,,,,function(e,t){}]);